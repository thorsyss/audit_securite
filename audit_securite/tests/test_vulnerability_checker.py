import unittest
from modules.vulnerability_checker import check_vulnerability

class TestVulnerabilityChecker(unittest.TestCase):

    def test_check_vulnerability_valid(self):
        # Simule un service vulnérable
        result = check_vulnerability("Apache", "2.4.49")
        self.assertIn("Vulnérabilités trouvées", result)
        
    def test_check_vulnerability_no_vuln(self):
        # Simule un service sans vulnérabilités
        result = check_vulnerability("nginx", "1.18")
        self.assertIn("Aucune vulnérabilité trouvée", result)

if __name__ == "__main__":
    unittest.main()
